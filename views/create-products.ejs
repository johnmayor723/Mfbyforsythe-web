<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Mfbyforesythebrand</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="#">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Products</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Orders</a></li>
      </ul>
    </div>
  </div>
</nav>
<!-- Product Drafts Section -->
<div class="container mt-5">
  <h3 class="mb-3">Product Drafts</h3>
  
  <% if (drafts && drafts.length > 0) { %>
    <div class="row">
      <% drafts.forEach(draft => { %>
        <div class="col-md-4 mb-4">
          <div class="card h-100">
            <% if (draft.images && draft.images.length > 0) { %>
              <img src="<%= draft.images[0] %>" class="card-img-top" alt="<%= draft.name %>">
            <% } else { %>
              <img src="/images/placeholder.png" class="card-img-top" alt="No Image">
            <% } %>
            <div class="card-body">
              <h5 class="card-title"><%= draft.name %></h5>
              <p class="card-text"><%= draft.description.substring(0, 100) %>...</p>
              <p><strong>Price:</strong> â‚¦<%= draft.price %></p>
              <div class="d-flex justify-content-between">
                <a href="/management/preview/<%= draft._id %>/edit" class="btn btn-sm btn-outline-primary">Edit</a>
                <form action="/management/preview/<%= draft._id %>/delete" method="POST" onsubmit="return confirm('Are you sure?');">
                  <input type="hidden" name="_method" value="DELETE">
                  <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                </form>
              </div>
            </div>
          </div>
        </div>
      <% }); %>
    </div>
    <!-- Publish Button -->
    <div class="text-end">
      <form action="/management/products/publish" method="POST">
        <button type="submit" class="btn btn-success">Publish Products</button>
      </form>
    </div>
  <% } else { %>
    <div class="alert alert-info">No product drafts to preview.</div>
  <% } %>
</div>
<!-- Product Form -->
<div class="container mt-4">
  <h2>Create Product</h2>
 <form action="/management/products/preview" method="POST" enctype="multipart/form-data">
  <div class="mb-3">
    <label class="form-label">Name:</label>
    <input type="text" class="form-control" name="name" required>
  </div>

  <div class="mb-3">
    <label class="form-label">Description:</label>
    <textarea class="form-control" name="description" required></textarea>
  </div>

  <div class="mb-3">
    <label class="form-label">Select Sizes:</label>
    <div class="d-flex flex-wrap gap-2">
      <% ['XS', 'S', 'M', 'L', 'XL', 'XXL'].forEach(size => { %>
        <label><input type="checkbox" name="size" value="<%= size %>"> <%= size %></label>
      <% }); %>
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">Price:</label>
    <input type="number" class="form-control" name="price" required>
  </div>

  <div class="mb-3">
    <label class="form-label">Select Colors:</label>
    <div class="d-flex flex-wrap gap-2">
      <% ['Black', 'White', 'Red', 'Blue', 'Green', 'Yellow', 'Purple', 'Pink', 'Gray', 'Brown', 'Beige', 'Orange', 'Teal', 'Navy', 'Burgundy', 'Olive', 'Mustard', 'Lavender', 'Turquoise'].forEach(color => { %>
        <label><input type="checkbox" name="colors" value="<%= color %>"> <%= color %></label>
      <% }); %>
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">Upload Images:</label>
    <div id="imageUploads">
      <input type="file" class="form-control" name="images" accept="image/*">
    </div>
    <button type="button" class="btn btn-secondary mt-2" id="addImage">+ Add More Images</button>
  </div>

  <!-- Image Previews -->
  <div id="imagePreviews" class="mt-3 d-flex flex-wrap gap-2"></div>

  <div class="mb-3">
    <label class="form-label">Category:</label>
    <select class="form-select" name="category" required>
      <optgroup label="Handbags">
        <option value="crossbody-bag">Crossbody Bag</option>
        <option value="shoulder-bag">Shoulder Bag</option>
        <option value="clutch">Clutch</option>
        <option value="backpack">Backpack</option>
        <option value="duffel-bag">Duffel Bag</option>
        <option value="travel-set">Travel Set</option>
      </optgroup>
      <optgroup label="Jackets">
        <option value="blazer">Blazer</option>
        <option value="denim-jacket">Denim Jacket</option>
        <option value="winter-jacket">Winter Jacket</option>
        <option value="bomber-jacket">Bomber Jacket</option>
      </optgroup>
      <optgroup label="Other Categories">
        <option value="t-shirt">T-shirt</option>
        <option value="dresses">Dresses</option>
        <option value="sets">Sets</option>
        <option value="kimono">Kimono</option>
        <option value="sweatshirts-hoodies">Sweatshirts & Hoodies</option>
        <option value="shirts">Shirts</option>
        <option value="sales">Sales</option>
      </optgroup>
    </select>
  </div>

  <button type="submit" class="btn btn-primary">Create Product</button>
</form>
</div>

<!-- Preview Script -->
<script>
  function createPreview(file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const img = document.createElement('img');
      img.src = e.target.result;
      img.style.maxWidth = '150px';
      img.style.maxHeight = '150px';
      img.classList.add('img-thumbnail');
      document.getElementById('imagePreviews').appendChild(img);
    };
    reader.readAsDataURL(file);
  }

  function setupImagePreview(input) {
    input.addEventListener('change', function () {
      for (let file of input.files) {
        createPreview(file);
      }
    });
  }

  // Setup for the initial input
  const initialInput = document.querySelector('#imageUploads input[type="file"]');
  setupImagePreview(initialInput);

  // Setup for dynamically added inputs
  document.getElementById('addImage').addEventListener('click', function () {
    const imageUploads = document.getElementById('imageUploads');
    const newInput = document.createElement('input');
    newInput.type = 'file';
    newInput.name = 'images';
    newInput.accept = 'image/*';
    newInput.classList.add('form-control', 'mt-2');

    imageUploads.appendChild(newInput);
    setupImagePreview(newInput);
  });
</script>